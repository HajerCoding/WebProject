<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Government</title>

    <!-- Bootstrap  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
          crossorigin="anonymous">

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
            crossorigin="anonymous"></script>
</head>

<body class="bg-light"
      style="
        font-family:'Times New Roman', Times, serif;
        color:#1f2937;
        background-color:#f8fafc;
        margin:0;
        letter-spacing:1px;
      ">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark" style="background-color:#1B3C53; letter-spacing:0;">
    <div class="container">

        <a class="navbar-brand d-flex align-items-center" href="index.html">
            <img src="logo.png" alt="Logo" height="30" class="me-2">
            <span class="fw-bold">AIM</span>
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="mainNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="index.html">Home |</a></li>
                <li class="nav-item"><a class="nav-link" href="About Us.html">About Us |</a></li>
                <li class="nav-item"><a class="nav-link" href="Farmer.html">Farmer |</a></li>
                <li class="nav-item"><a class="nav-link active" href="Government.html">Government |</a></li>
                <li class="nav-item"><a class="nav-link" href="Company.html">Company |</a></li>
                <li class="nav-item"><a class="nav-link" href="Researcher.html">Researcher |</a></li>
                <li class="nav-item"><a class="nav-link" href="Analytics.html">Analytics |</a></li>
                <li class="nav-item"><a class="nav-link" href="questionnaire.html">Questionnaire |</a></li>
                <li class="nav-item"><a class="nav-link" href="funpage.html">Fun Page |</a></li>
                <li class="nav-item"><a class="nav-link" href="calculator.html">Calculate |</a></li>
                <li class="nav-item"><a class="nav-link" href="Contact Us.html">Contact Us</a></li>
            </ul>
        </div>
    </div>
</nav>

<!-- Hero Section -->
<section class="py-5 text-white" style="background-color:#1B3C53;">
    <div class="container">
        <div class="row align-items-center g-4">
            <div class="col-lg-7">
                <h1 class="display-5 fw-bold mb-3">Government</h1>
                <p class="lead mb-3">
                    Empowering decision-makers with data-driven insights for sustainable water management in Oman.
                </p>
                <span class="badge bg-warning text-dark">Oman Vision 2040</span>
            </div>
            <div class="col-lg-5 text-center">
                <img src="Government.jpg" class="img-fluid rounded shadow" alt="Wadi Dayqah Dam">
            </div>
        </div>
    </div>
</section>

<!-- Benefits Section -->
<section class="py-5 bg-white">
    <div class="container">
        <h2 class="text-center fw-bold mb-4">üåü Benefits for Government</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100 text-center shadow-sm border-0">
                    <div class="card-body">
                        <h5 class="card-title mt-3">üåê Data-Driven Policies</h5>
                        <p class="card-text">
                            Access aggregated water-usage data to design informed distribution and sustainability policies.
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 text-center shadow-sm border-0">
                    <div class="card-body">
                        <h5 class="card-title mt-3">‚ö†Ô∏è Overuse Prevention</h5>
                        <p class="card-text">
                            Monitor over-consumption and protect Oman's aquifers from unsustainable extraction.
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 text-center shadow-sm border-0">
                    <div class="card-body">
                        <h5 class="card-title mt-3">üìä Efficiency Evaluation</h5>
                        <p class="card-text">
                            Compare regional performance and plan equitable resource allocation for sustainable growth.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Tools & Dynamic Table Section -->
<section class="py-5 bg-light" id="tools">
    <div class="container">
        <h2 class="text-center fw-bold mb-4">üõ†Ô∏è Government Tools &amp; Resources</h2>

        <div class="row g-4 mb-4">
            <!-- Form that saves data in DB using PHP + SQL -->
            <div class="col-md-6">
                <div class="card shadow-sm border-0 h-100">
                    <div class="card-body">
                        <h5 class="card-title mb-3">
                            ‚úÖ Save Regional Record in Database
                        </h5>

                        <!-- This form sends data to process_government.php -->
                        <form name="GovDBForm"
                              id="gov-db-form"
                              action="process_government.php"
                              method="post"
                              onsubmit="return validateGovDB();">

                            <div class="row g-3">
                                <!-- Region -->
                                <div class="col-12">
                                    <label for="db-region" class="form-label">Region Name:</label>
                                    <input type="text" id="db-region" name="region" class="form-control">
                                </div>

                                <!-- January -->
                                <div class="col-md-4">
                                    <label for="db-jan" class="form-label">January (L):</label>
                                    <input type="number" id="db-jan" name="jan" class="form-control">
                                </div>

                                <!-- February -->
                                <div class="col-md-4">
                                    <label for="db-feb" class="form-label">February (L):</label>
                                    <input type="number" id="db-feb" name="feb" class="form-control">
                                </div>

                                <!-- March -->
                                <div class="col-md-4">
                                    <label for="db-mar" class="form-label">March (L):</label>
                                    <input type="number" id="db-mar" name="mar" class="form-control">
                                </div>

                                <!-- Submit -->
                                <div class="col-12">
                                    <button type="submit"
                                            class="btn btn-primary w-100 mt-2"
                                            style="background-color:#3C467B; border-color:#3C467B;">
                                        Save Record (SQL)
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- (2) Form and dashboard that work with JavaScript only -->
            <div class="col-md-6">
                <div class="card shadow-sm border-0 h-100">
                    <div class="card-body">
                        <h5 class="card-title mb-3">
                            ‚ûï Add Regional Water-Usage Record (Dashboard)
                        </h5>

                        <!-- This form updates the JS array and the summary below -->
                        <form id="add-region-form" onsubmit="return addRegion();">
                            <div class="row g-3">
                                <!-- Region -->
                                <div class="col-12">
                                    <label for="new-region" class="form-label">Region Name:</label>
                                    <input type="text" id="new-region" class="form-control">
                                </div>

                                <!-- January -->
                                <div class="col-md-4">
                                    <label for="new-jan" class="form-label">January (L):</label>
                                    <input type="number" id="new-jan" class="form-control">
                                </div>

                                <!-- February -->
                                <div class="col-md-4">
                                    <label for="new-feb" class="form-label">February (L):</label>
                                    <input type="number" id="new-feb" class="form-control">
                                </div>

                                <!-- March -->
                                <div class="col-md-4">
                                    <label for="new-mar" class="form-label">March (L):</label>
                                    <input type="number" id="new-mar" class="form-control">
                                </div>

                                <!-- Submit -->
                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary w-100 mt-2">
                                        Add Record
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dynamic Table (show the result in the same page using javascript)-->
        <div class="card shadow-sm border-0 mb-4">
            <div class="card-body">
                <h5 class="card-title mb-3">
                    Regional Water Usage Summary
                </h5>
                <div class="table-responsive">
                    <table class="table table-striped table-bordered align-middle">
                        <thead class="table-dark">
                        <tr>
                            <th rowspan="2">Region</th>
                            <th colspan="3" class="text-center">Water Usage (Liters)</th>
                        </tr>
                        <tr>
                            <th>January</th>
                            <th>February</th>
                            <th>March</th>
                        </tr>
                        </thead>
                        <tbody id="region-table-body">
                        <!-- Rows will be added by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Monthly Report (Dashboard only) -->
        <div class="card shadow-sm border-0">
            <div class="card-body text-center">
                <h5 class="card-title mb-3">
                    Monthly Report (From Dashboard Data)
                </h5>

                <!-- Totals -->
                <p class="fw-bold mb-2">Total Water Usage</p>
                <div class="row mb-3">
                    <div class="col-md-4">
                        <p class="mb-1">January</p>
                        <p id="jan-total" class="fw-semibold">‚Äì</p>
                    </div>
                    <div class="col-md-4">
                        <p class="mb-1">February</p>
                        <p id="feb-total" class="fw-semibold">‚Äì</p>
                    </div>
                    <div class="col-md-4">
                        <p class="mb-1">March</p>
                        <p id="mar-total" class="fw-semibold">‚Äì</p>
                    </div>
                </div>

                <!-- Averages -->
                <p class="fw-bold mb-2">Average Usage per Region</p>
                <div class="row">
                    <div class="col-md-4">
                        <p class="mb-1">January</p>
                        <p id="jan-avg" class="fw-semibold">‚Äì</p>
                    </div>
                    <div class="col-md-4">
                        <p class="mb-1">February</p>
                        <p id="feb-avg" class="fw-semibold">‚Äì</p>
                    </div>
                    <div class="col-md-4">
                        <p class="mb-1">March</p>
                        <p id="mar-avg" class="fw-semibold">‚Äì</p>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>

<!-- Footer -->
<footer class="bg-dark text-white py-4 mt-5">
    <div class="container">
        <p class="mb-0">&copy; 2025 AgriSense - All rights reserved.</p>
    </div>
</footer>

<script>
/* 
   validateGovDB()
   This function validates the SQL form before sending data
   to process_government.php. It checks that region is not
   empty and that the 3 month values are positive numbers
 */
function validateGovDB() {
    var form  = document.forms["GovDBForm"];
    var region = form["region"].value.trim();
    var jan    = form["jan"].value;
    var feb    = form["feb"].value;
    var mar    = form["mar"].value;

    // Check region name
    if (region === "") {
        alert("Please enter a region name.");
        form["region"].focus();
        return false;
    }
    // Check January value
    if (jan === "" || jan <= 0) {
        alert("Please enter a positive value for January.");
        form["jan"].focus();
        return false;
    }
    // Check February value
    if (feb === "" || feb <= 0) {
        alert("Please enter a positive value for February.");
        form["feb"].focus();
        return false;
    }
    // Check March value
    if (mar === "" || mar <= 0) {
        alert("Please enter a positive value for March.");
        form["mar"].focus();
        return false;
    }

    // If validation passed ‚Üí allow form submission
    return true;
}

/*
   RegionUsage() Constructor
   This creates an object that stores one region‚Äôs water
   usage values. 
 */
function RegionUsage(region, january, february, march) {
    this.region   = region;
    this.january  = january;
    this.february = february;
    this.march    = march;
}

/* 
   regionData Array
   This global array stores multiple RegionUsage objects.
   These are used ONLY for the dashboard (not SQL).
   We start with 3 example regions.
 */
var regionData = [
    new RegionUsage("Muscat", 1200000, 1150000, 1300000),
    new RegionUsage("Salalah", 950000, 980000, 1020000),
    new RegionUsage("Nizwa", 800000, 820000, 850000)
];

/*
   renderRegionTable()
   This function displays the contents of regionData[] in
   the HTML table. Called whenever data changes.
 */
function renderRegionTable() {
    var tbody = document.getElementById("region-table-body");
    var rows = "";

    // Loop through array and build table rows
    for (var i = 0; i < regionData.length; i++) {
        var entry = regionData[i];
        rows += "<tr>" +
                "<td>" + entry.region + "</td>" +
                "<td>" + entry.january + "</td>" +
                "<td>" + entry.february + "</td>" +
                "<td>" + entry.march + "</td>" +
                "</tr>";
    }

    tbody.innerHTML = rows;
}

/* 
   updateMonthlySummary()
   This calculates total and average usage for each month
   based on the regionData[] values. It updates the numbers
   shown in the dashboard's "Monthly Report".
*/
function updateMonthlySummary() {
    var count = regionData.length;

    // Get HTML output labels
    var janTotal = document.getElementById("jan-total");
    var febTotal = document.getElementById("feb-total");
    var marTotal = document.getElementById("mar-total");
    var janAvg   = document.getElementById("jan-avg");
    var febAvg   = document.getElementById("feb-avg");
    var marAvg   = document.getElementById("mar-avg");

    // If no data, reset values
    if (count === 0) {
        janTotal.innerHTML = "-";
        febTotal.innerHTML = "-";
        marTotal.innerHTML = "-";
        janAvg.innerHTML   = "-";
        febAvg.innerHTML   = "-";
        marAvg.innerHTML   = "-";
        return;
    }

    // Sum all months
    var sumJan = 0, sumFeb = 0, sumMar = 0;
    for (var i = 0; i < count; i++) {
        sumJan += regionData[i].january;
        sumFeb += regionData[i].february;
        sumMar += regionData[i].march;
    }

    // Calculate averages
    var avgJan = Math.round(sumJan / count);
    var avgFeb = Math.round(sumFeb / count);
    var avgMar = Math.round(sumMar / count);

    // Update HTML
    janTotal.innerHTML = sumJan + " L";
    febTotal.innerHTML = sumFeb + " L";
    marTotal.innerHTML = sumMar + " L";

    janAvg.innerHTML = avgJan + " L";
    febAvg.innerHTML = avgFeb + " L";
    marAvg.innerHTML = avgMar + " L";
}

/* 
   addRegion()
   This handles the dashboard form (JS only).
   It validates inputs, creates a new RegionUsage object,
   pushes it into regionData[], and updates the table.
 */
function addRegion() {
    var regionInput = document.getElementById("new-region");
    var janInput    = document.getElementById("new-jan");
    var febInput    = document.getElementById("new-feb");
    var marInput    = document.getElementById("new-mar");

    // Get user input
    var region = regionInput.value.trim();
    var jan    = janInput.value;
    var feb    = febInput.value;
    var mar    = marInput.value;

    // Simple validation
    if (region === "") {
        alert("Please enter a region name for the dashboard.");
        regionInput.focus();
        return false;
    }
    if (jan === "" || isNaN(jan) || jan <= 0) {
        alert("Please enter a positive number for January (dashboard).");
        janInput.focus();
        return false;
    }
    if (feb === "" || isNaN(feb) || feb <= 0) {
        alert("Please enter a positive number for February (dashboard).");
        febInput.focus();
        return false;
    }
    if (mar === "" || isNaN(mar) || mar <= 0) {
        alert("Please enter a positive number for March (dashboard).");
        marInput.focus();
        return false;
    }

    // Convert string input to numbers
    var janNum = parseInt(jan);
    var febNum = parseInt(feb);
    var marNum = parseInt(mar);

    // Add new region object to our JS array
    regionData.push(new RegionUsage(region, janNum, febNum, marNum));

    // Clear input fields
    regionInput.value = "";
    janInput.value = "";
    febInput.value = "";
    marInput.value = "";

    // Refresh table + monthly report
    renderRegionTable();
    updateMonthlySummary();

    // Prevent real form submission
    return false;
}

/*
   initDashboard()
   This runs when the page loads. It renders the initial
   table and calculates totals/averages for the starting
   values in regionData[].
 */
function initDashboard() {
    renderRegionTable();
    updateMonthlySummary();
}

// Call initDashboard when the page is fully loaded
window.onload = initDashboard;
</script>


</body>
</html>
